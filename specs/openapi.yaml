openapi: 3.0.0
info:
  title: Restaurant Ordering API
  description: A restaurant ordering system with authentication and restaurant management
  version: 1.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: http://localhost:8080/api
    description: Development server
  - url: https://api.restaurant.example.com/v1
    description: Production server
security:
  - BearerAuth: []
paths:
  /auth/register:
    post:
      summary: Register a new user
      description: Creates a new user account with CUSTOMER role by default. Returns the created user object.
      operationId: registerUser
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
      responses:
        "201":
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
        "409":
          description: User already exists
  /auth/login:
    post:
      summary: Authenticate user and get JWT token
      description: Authenticates user credentials and returns a JWT token for accessing protected endpoints.
      operationId: loginUser
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LoginResponse"
        "400":
          description: Invalid or missing request body
        "401":
          description: Invalid credentials
  /auth/logout:
    post:
      summary: Logout user (invalidate token)
      description: Invalidates the current JWT token, logging the user out of the system.
      operationId: logoutUser
      responses:
        "200":
          description: Logout successful
        "401":
          description: Unauthorized - invalid or missing token
  /auth/me:
    get:
      summary: Get current user profile
      description: Returns the profile information for the currently authenticated user.
      operationId: getCurrentUser
      responses:
        "200":
          description: Current user info
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "401":
          description: Unauthorized - invalid or missing token
  /restaurants:
    get:
      summary: List all restaurants
      description: Retrieves a paginated list of all active restaurants. Supports pagination via page and size parameters.
      operationId: getRestaurants
      security: []
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed) for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: List of restaurants
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RestaurantPage"
        "400":
          description: Invalid query parameters
    post:
      summary: Create a new restaurant
      description: Creates a new restaurant entry. Requires ADMIN role. The authenticated user will be set as the restaurant owner.
      operationId: createRestaurant
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateRestaurantRequest"
      responses:
        "201":
          description: Restaurant created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Restaurant"
        "400":
          description: Invalid request
        "403":
          description: Forbidden - requires admin role
  /restaurants/{restaurantId}:
    get:
      summary: Get a specific restaurant
      description: Retrieves detailed information about a specific restaurant by its ID.
      operationId: getRestaurant
      security: []
      parameters:
        - name: restaurantId
          in: path
          required: true
          description: Unique identifier of the restaurant
          schema:
            type: string
      responses:
        "200":
          description: Restaurant found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Restaurant"
        "400":
          description: Invalid restaurantId format
        "404":
          description: Restaurant not found
    put:
      summary: Update a restaurant
      description: Updates an existing restaurant's information. Requires ADMIN role.
      operationId: updateRestaurant
      parameters:
        - name: restaurantId
          in: path
          required: true
          description: Unique identifier of the restaurant to update
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateRestaurantRequest"
      responses:
        "200":
          description: Restaurant updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Restaurant"
        "400":
          description: Invalid restaurantId format or request body
        "403":
          description: Forbidden - requires admin role
        "404":
          description: Restaurant not found
    delete:
      summary: Delete a restaurant
      description: Permanently deletes a restaurant and all associated data. Requires ADMIN role.
      operationId: deleteRestaurant
      parameters:
        - name: restaurantId
          in: path
          required: true
          description: Unique identifier of the restaurant to delete
          schema:
            type: string
      responses:
        "204":
          description: Restaurant deleted
        "400":
          description: Invalid restaurantId format
        "403":
          description: Forbidden - requires admin role
        "404":
          description: Restaurant not found
  /orders:
    get:
      summary: List all orders
      description: Retrieves a list of orders. Can be filtered by restaurant, user, and/or status. Users can only see their own orders unless they have ADMIN or RESTAURANT_OWNER role.
      operationId: getOrders
      parameters:
        - name: restaurantId
          in: query
          description: Filter orders by restaurant ID
          schema:
            type: string
        - name: userId
          in: query
          description: Filter orders by user ID
          schema:
            type: string
        - name: status
          in: query
          description: Filter orders by status
          schema:
            type: string
            enum: [pending, preparing, ready, completed, cancelled]
      responses:
        "200":
          description: List of orders
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Order"
        "400":
          description: Invalid query parameters
        "401":
          description: Unauthorized - invalid or missing token
    post:
      summary: Create a new order
      description: Creates a new order for a restaurant. Customer must be authenticated. Order must contain at least one item.
      operationId: createOrder
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrderRequest"
      responses:
        "201":
          description: Order created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "400":
          description: Invalid request
        "401":
          description: Unauthorized - authentication required
  /orders/{orderId}:
    get:
      summary: Get a specific order
      description: Retrieves detailed information about a specific order by its ID. Users can only access their own orders unless they have ADMIN or RESTAURANT_OWNER role.
      operationId: getOrder
      parameters:
        - name: orderId
          in: path
          required: true
          description: Unique identifier of the order
          schema:
            type: string
      responses:
        "200":
          description: Order found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "400":
          description: Invalid orderId format
        "401":
          description: Unauthorized - authentication required
        "404":
          description: Order not found
    put:
      summary: Update an order
      description: Updates an existing order. Only allowed for orders in 'pending' status unless user has ADMIN role. Can update items, customer info, and status.
      operationId: updateOrder
      parameters:
        - name: orderId
          in: path
          required: true
          description: Unique identifier of the order to update
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateOrderRequest"
      responses:
        "200":
          description: Order updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Order"
        "400":
          description: Invalid orderId format or request body
        "401":
          description: Unauthorized - authentication required
        "404":
          description: Order not found
    delete:
      summary: Delete an order
      description: Cancels and deletes an order. Only the order owner or users with ADMIN/RESTAURANT_OWNER role can delete orders.
      operationId: deleteOrder
      parameters:
        - name: orderId
          in: path
          required: true
          description: Unique identifier of the order to delete
          schema:
            type: string
      responses:
        "204":
          description: Order deleted
        "400":
          description: Invalid orderId format
        "401":
          description: Unauthorized - authentication required
        "404":
          description: Order not found
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for Spring Security authentication
  schemas:
    User:
      type: object
      description: User account information
      properties:
        id:
          type: string
          description: Unique user identifier (UUID)
        username:
          type: string
          description: Unique user login name
        email:
          type: string
          format: email
          description: User email address
        firstName:
          type: string
          description: User's first name
        lastName:
          type: string
          description: User's last name
        roles:
          type: array
          description: User roles for authorization
          items:
            type: string
            enum: [CUSTOMER, RESTAURANT_OWNER, ADMIN]
        createdAt:
          type: string
          format: date-time
          description: Account creation timestamp
    RegisterRequest:
      type: object
      description: Request body for user registration
      required:
        - username
        - email
        - password
      properties:
        username:
          type: string
          description: Unique username for login
          minLength: 3
          maxLength: 50
        email:
          type: string
          format: email
          description: User's email address
        password:
          type: string
          minLength: 8
          maxLength: 100
          description: Must contain at least one uppercase, one lowercase, one digit
        firstName:
          type: string
          description: User's first name (optional)
          maxLength: 50
        lastName:
          type: string
          description: User's last name (optional)
          maxLength: 50
    LoginRequest:
      type: object
      description: Request body for user authentication
      required:
        - username
        - password
      properties:
        username:
          type: string
          description: User's registered username
        password:
          type: string
          description: User's password
    LoginResponse:
      type: object
      description: Response containing authentication token and user info
      properties:
        accessToken:
          type: string
          description: JWT access token
        tokenType:
          type: string
          description: Type of authentication token
          example: Bearer
        expiresIn:
          type: integer
          description: Token expiration time in seconds
        user:
          $ref: "#/components/schemas/User"
    Restaurant:
      type: object
      description: Restaurant business information
      properties:
        id:
          type: string
          description: Unique restaurant identifier (UUID)
        name:
          type: string
          description: Restaurant business name
        description:
          type: string
          description: Brief description of the restaurant
        address:
          type: string
          description: Physical address of the restaurant
        phone:
          type: string
          description: Contact phone number
        email:
          type: string
          format: email
          description: Contact email address
        cuisineType:
          type: string
          description: Type of cuisine (e.g., Italian, Asian, American)
        openingHours:
          type: string
          description: "Business hours (e.g., Mon-Fri: 9AM-10PM)"
        ownerId:
          type: string
          description: User ID of the restaurant owner
        isActive:
          type: boolean
          description: Whether the restaurant is currently active and accepting orders
        createdAt:
          type: string
          format: date-time
          description: Restaurant creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
    CreateRestaurantRequest:
      type: object
      description: Request body for creating a new restaurant
      required:
        - name
        - address
      properties:
        name:
          type: string
          description: Restaurant business name
          minLength: 1
          maxLength: 100
        description:
          type: string
          description: Brief description of the restaurant (optional)
          maxLength: 500
        address:
          type: string
          description: Physical address of the restaurant
          maxLength: 200
        phone:
          type: string
          description: Contact phone number (optional)
          maxLength: 20
        email:
          type: string
          format: email
          description: Contact email address (optional)
        cuisineType:
          type: string
          description: Type of cuisine served (optional)
          maxLength: 50
        openingHours:
          type: string
          description: Operating hours (optional)
          maxLength: 100
    UpdateRestaurantRequest:
      type: object
      description: Request body for updating an existing restaurant
      properties:
        name:
          type: string
          description: Restaurant business name (optional)
          minLength: 1
          maxLength: 100
        description:
          type: string
          description: Brief description of the restaurant (optional)
          maxLength: 500
        address:
          type: string
          description: Physical address of the restaurant (optional)
          maxLength: 200
        phone:
          type: string
          description: Contact phone number (optional)
          maxLength: 20
        email:
          type: string
          format: email
          description: Contact email address (optional)
        cuisineType:
          type: string
          description: Type of cuisine served (optional)
          maxLength: 50
        openingHours:
          type: string
          description: Operating hours (optional)
          maxLength: 100
        isActive:
          type: boolean
          description: Whether the restaurant is active (optional)
    RestaurantPage:
      type: object
      description: Paginated response for restaurant listings
      properties:
        content:
          type: array
          description: List of restaurants on this page
          items:
            $ref: "#/components/schemas/Restaurant"
        totalElements:
          type: integer
          description: Total number of restaurants available
        totalPages:
          type: integer
          description: Total number of pages
        number:
          type: integer
          description: Current page number (0-indexed)
        size:
          type: integer
          description: Number of items per page
    Order:
      type: object
      description: Customer order information
      properties:
        id:
          type: string
          description: Unique order identifier (UUID)
        restaurantId:
          type: string
          description: ID of the restaurant fulfilling the order
        customerId:
          type: string
          description: User ID who placed the order (null for guest orders)
        customerName:
          type: string
          description: Customer name (for guest orders or display purposes)
        customerEmail:
          type: string
          format: email
          description: Customer email for order notifications
        items:
          type: array
          description: List of items in the order
          items:
            $ref: "#/components/schemas/OrderItem"
        status:
          type: string
          enum: [pending, preparing, ready, completed, cancelled]
          description: Current order status
        totalAmount:
          type: number
          description: Total order amount in dollars
        specialInstructions:
          type: string
          description: Special requests or dietary requirements
        createdAt:
          type: string
          format: date-time
          description: Order creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last status update timestamp
    OrderItem:
      type: object
      description: Individual item within an order
      properties:
        itemId:
          type: string
          description: Menu item identifier
        name:
          type: string
          description: Menu item name
        quantity:
          type: integer
          minimum: 1
          description: Quantity ordered
        unitPrice:
          type: number
          description: Price per unit in dollars
        subtotal:
          type: number
          description: Total for this item (quantity * unitPrice) in dollars
    CreateOrderRequest:
      type: object
      description: Request body for creating a new order
      required:
        - restaurantId
        - items
      properties:
        restaurantId:
          type: string
          description: Restaurant ID to place order with
        customerName:
          type: string
          description: Name of the customer (optional for authenticated users)
          minLength: 1
          maxLength: 100
        customerEmail:
          type: string
          format: email
          description: Email for order notifications (optional for authenticated users)
        items:
          type: array
          description: List of items to order
          minItems: 1
          items:
            type: object
            required:
              - itemId
              - quantity
            properties:
              itemId:
                type: string
                description: ID of the menu item
              quantity:
                type: integer
                description: Number of this item to order
                minimum: 1
        specialInstructions:
          type: string
          description: Special requests or dietary requirements (optional)
          maxLength: 500
    UpdateOrderRequest:
      type: object
      description: Request body for updating an existing order
      properties:
        customerName:
          type: string
          description: Name of the customer (optional)
          minLength: 1
          maxLength: 100
        customerEmail:
          type: string
          format: email
          description: Email for order notifications (optional)
        items:
          type: array
          description: Updated list of items (optional)
          minItems: 1
          items:
            type: object
            required:
              - itemId
              - quantity
            properties:
              itemId:
                type: string
                description: ID of the menu item
              quantity:
                type: integer
                description: Number of this item to order
                minimum: 1
        status:
          type: string
          description: New order status (optional, restricted based on current status)
          enum: [pending, preparing, ready, completed, cancelled]
        specialInstructions:
          type: string
          description: Special requests or dietary requirements (optional)
          maxLength: 500
